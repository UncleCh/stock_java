<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.it.repository.FinanceMapper" >

    <resultMap id="FinanceMap" type="com.it.bean.Finance" />

    <select id="getStock" resultMap="FinanceMap"  >
        select * from code
        <where>
            <if test="dt != null">
                dt = #{dt}
            </if>
            <if test="code != null">
                code = #{code}
            </if>
        </where>
    </select>

    <select id="exits" resultType="boolean"  >
        select count(1) from finance where   dt = #{dt} and  code = #{code}
    </select>




    <select id="countFinanceByCode" resultType="int">
        select count(1) from finance
        <where>
            <if test="code != null">
                and code = #{code} and income != 0
            </if>
            <if test="dt != null">
                and dt = #{dt} and income != 0
            </if>
        </where>
        ORDER BY dt desc;
    </select>

    <insert id="saveFinance" >
        insert into finance (code,dt,income,income_per,market_income,market_income_per,per_income,
        per_assets,per_cacsh,self_assets_per,self_market_per)
        values (#{code}, #{dt},#{income},#{incomePer},#{marketIncome},#{marketIncomePer},
        #{perIncome},#{perAssets},#{perCacsh},#{selfAssetsPer},#{selfMarketPer})
    </insert>

    <update id="updateStock">
        UPDATE code SET
        weight = #{weight}
        <where>
            <if test="code != null">
                code = #{code}
            </if>
        </where>
    </update>

    <delete id="delete">
        delete from code
        <where>
            <if test="code != null">
                code = #{code}
            </if>
            <if test=" dt != null">
                dt = #{dt}
            </if>
        </where>
    </delete>

</mapper>